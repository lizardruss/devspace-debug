version: v2beta1
localRegistry:
  enabled: false
images:
  api-service:
    image: lizardruss/api-service
    skipPush: true

deployments:
  api-service:
    helm:
      values:
        labels:
          service: api-service
        containers:
          - image: lizardruss/api-service

dev:
  api-service:
    imageSelector: lizardruss/api-service
    devImage: node:18.8-alpine
    workingDir: /usr/app/api-service
    command: ["npm", "run", "dev"]
    logs: {}
    persistPaths:
      - path: /usr/app
        volumePath: api-service
    persistenceOptions:
      size: 5Gi
      accessModes:
        - ReadWriteMany
      name: pnpm-pvc
    sync:
      - path: ./
        initialSync: preferLocal
        printLogs: true
        disableDownload: true
        onUpload:
          restartContainer: true
          exec:
            - command: "npm install"
              onChange: ["./package-lock.json"]
  front-service:
    labelSelector:
      service: front-service
    logs: {}
  back-service:
    labelSelector:
      service: back-service
    logs: {}
