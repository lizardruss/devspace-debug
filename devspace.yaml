version: v2beta1
name: hot-reload-container-restart

vars:
  IMAGE: myusername/devspace

images:
  my-image:
    image: ${IMAGE}
    rebuildStrategy: ignoreContextChanges

deployments:
  my-deployment:
    helm:
      values:
        containers:
        - image: ${IMAGE}

dev:
  my-dev:
    imageSelector: ${IMAGE}
    devImage: ghcr.io/loft-sh/devspace-containers/go:1.20-alpine
    command: ["go", "run", "/app/main.go"]
    logs: {}
    ports:
    - port: 8080
    sync:
    - path: ./pkg
      onUpload:
        restartContainer: true
    - path: ./pkg
      onUpload:
        restartContainer: true
    - path: main.go
      file: true
      onUpload:
        restartContainer: true
